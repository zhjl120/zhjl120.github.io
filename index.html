<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> WangEX`s Blog</title><meta name="description" content="Web安全研究"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.jpg"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://goodwaf.com/atom.xml" title="WangEX`s Blog"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.jpg" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link active">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><ul class="home post-list"><li class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2017/04/21/phpcms_xss/" class="post-title-link">PHPCMS V9 全版本反射型XSS</a></h2><div class="post-info">2017年4月21日</div><div class="post-content"><h4 id="一、背景"><a href="#一、背景" class="headerlink" title="一、背景"></a>一、背景</h4><p>这个XSS漏洞是由于PHPCMS的cookie可以由用户控制，而在输出时又没有进行过滤所造成。而且该漏洞的payload是经过加密的，无视WAF检测。<br></div><a href="/2017/04/21/phpcms_xss/" class="read-more">...more</a></article></li><li class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2017/04/21/phpcms_file_down/" class="post-title-link">PHPCMS V9 任意文件下载(Windows)</a></h2><div class="post-info">2017年4月21日</div><div class="post-content"><h4 id="一、背景"><a href="#一、背景" class="headerlink" title="一、背景"></a>一、背景</h4><p>任意文件下载漏洞和<a href="http://paper.seebug.org/275/">《PHPCMS v9.6.0 wap模块 SQL注入》</a>在同一个文件，只不过触发点在download函数。<br></div><a href="/2017/04/21/phpcms_file_down/" class="read-more">...more</a></article></li><li class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2017/02/18/jieqicms_sqli/" class="post-title-link">JieQiCMS(V1.7)无需登录SQL注入</a></h2><div class="post-info">2017年2月18日</div><div class="post-content"><h4 id="一、背景"><a href="#一、背景" class="headerlink" title="一、背景"></a>一、背景</h4><p>在官网下载了jieqicms，发现使用了zend加密，通过dzend后发现一处update延时注入。在审计的时候发现这套系统不仅安全防范做的不错还对源码加了密，但是感觉作者在对update类型的数据库查询时并没有做较多防范。</p></div><a href="/2017/02/18/jieqicms_sqli/" class="read-more">...more</a></article></li><li class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2017/01/16/duomicms_sqli/" class="post-title-link">DuomiCMS前台SQL注入</a></h2><div class="post-info">2017年1月16日</div><div class="post-content"><h4 id="一、背景"><a href="#一、背景" class="headerlink" title="一、背景"></a>一、背景</h4><ol>
<li>duomicms在SQL防注入方面做了2层安全检测，第一层检测是在代码入口处，使用了360的简易WAF规则。第二层是在数据库查询入口处使用了dedecms的SQL检测函数。</li>
<li>duomicms使用了伪全局变量，对GET/POST/COOKIE中的变量做了addslashes</li>
</ol></div><a href="/2017/01/16/duomicms_sqli/" class="read-more">...more</a></article></li><li class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2017/01/05/pigcms_sqli/" class="post-title-link">PigCMS前台SQL注入</a></h2><div class="post-info">2017年1月5日</div><div class="post-content"><h4 id="一、背景"><a href="#一、背景" class="headerlink" title="一、背景"></a>一、背景</h4><p>这个洞是很久以前刚学习代码审计的时候发现的，其中还找到了一个thinkPHP的漏洞，虽然后来发现p牛很早就已经公布了这个洞，但是作为刚入门时独立挖到的还是留个纪念吧，BTW，这篇文章的重点并不在PigCMS，因为这个系统的漏洞实在太多了。</p></div><a href="/2017/01/05/pigcms_sqli/" class="read-more">...more</a></article></li><li class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2016/12/30/基于约束条件的SQL攻击/" class="post-title-link">基于约束条件的SQL攻击</a></h2><div class="post-info">2016年12月30日</div><div class="post-content"><h4 id="一、背景"><a href="#一、背景" class="headerlink" title="一、背景"></a>一、背景</h4><p>今天看了一篇<a href="https://dhavalkapil.com/blogs/SQL-Attack-Constraint-Based/">基于约束条件的SQL攻击</a>的文章，感觉非常不错，但亲自实践后又发现了很多问题，虽然利用起来有一定要求，不过作者的思想还是很值得学习的。原文中的主旨思想是利用数据库对空格符的特殊处理方式来达到水平越权的目的。以下内容以MySQL为例，其它数据库可能也存在这个问题（文章作者实验了MySQL和SQLite），我也在MySQL上复现了这个问题。<br></div><a href="/2016/12/30/基于约束条件的SQL攻击/" class="read-more">...more</a></article></li><li class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2016/11/30/DedeCMS-CheckSql函数绕过/" class="post-title-link">DedeCMS CheckSql函数绕过</a></h2><div class="post-info">2016年11月30日</div><div class="post-content"><p>DedeCMS自带了一个函数来检查SQL语句以防止注入，该函数是由80sec提供的通用SQL过滤函数。很多其它程序也使用了该函数，最近就碰到一个。但是由于该函数的设计缺陷导致其可以被绕过。代码如下:</p></div><a href="/2016/11/30/DedeCMS-CheckSql函数绕过/" class="read-more">...more</a></article></li><li class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2016/10/27/字符编码学习笔记/" class="post-title-link">字符编码学习笔记</a></h2><div class="post-info">2016年10月27日</div><div class="post-content"><ul>
<li><strong>ACSII</strong> <ul>
<li><strong>规定</strong>：一个字符由一个字节存储。</li>
<li><strong>范围</strong>：<ul>
<li>前32位（0x00 — 0x20）为控制码。</li>
<li>第32位至127位（0x20 — 0x7f）为空格、标点符号、数字、字母。</li>
<li>127位以后不用。</li>
</ul>
</li>
</ul>
</li>
</ul></div><a href="/2016/10/27/字符编码学习笔记/" class="read-more">...more</a></article></li><li class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2016/10/25/Bypass-WAF-Cookbook/" class="post-title-link">Bypass WAF Cookbook</a></h2><div class="post-info">2016年10月25日</div><div class="post-content"><h4 id="一、前言"><a href="#一、前言" class="headerlink" title="一、前言"></a>一、前言</h4><p>本文整理自wooyun drops上的几篇文章以及自己fuzz出来的一些特征，wooyun文章以《Bypass WAF Cookbook》内容为主体，作者为MayIKissYou，本文是精简过后的内容，主要用于自己平时查询。更详细的内容请参考原文。</p></div><a href="/2016/10/25/Bypass-WAF-Cookbook/" class="read-more">...more</a></article></li><li class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2016/10/23/Web渗透测试思路整理/" class="post-title-link">Web渗透测试思路整理</a></h2><div class="post-info">2016年10月23日</div><div class="post-content"><h4 id="信息收集："><a href="#信息收集：" class="headerlink" title="信息收集："></a>信息收集：</h4><ul>
<li>域名/IP<ul>
<li>子域名列表</li>
<li>whois: 注册地址，注册人，联系方式等</li>
<li>whois反查： 同ip有哪些站点(旁注)，同一个注册人注册了哪些域名</li>
<li>社工注册人信息</li>
</ul>
</li>
</ul></div><a href="/2016/10/23/Web渗透测试思路整理/" class="read-more">...more</a></article></li></ul></main><footer><div class="paginator"><a href="/page/2/" class="next">NEXT</a></div><div class="copyright"><p>© 2015 - 2017 <a href="http://goodwaf.com">wangex</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script></body></html>